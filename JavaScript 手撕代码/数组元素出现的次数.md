## 数组元素出现的次数

假设现在有一个数组，数组内元素可能有重复，需要统计数组内每个元素重复的次数

```js
const arr = [1, 2, 5, 5, 2, 4, "hello", "hey", "hello"];

console.log(countFrequency(arr)); // {1: 1, 2: 2, 5: 2, 4: 1, hello: 2, hey: 1}
```

比如，数组 `[1, 2, 5, 5, 2, 4,'hello','hey','hello']` 内元素出现的次数为 `{1: 1, 2: 2, 5: 2, 4: 1, hello: 2, hey: 1}`

那要实现 `countFrequency` 函数其实不难，要抓住一个点，**使用键值对结构，键是数组的元素，值是元素出现的次数**

```js
function countFrequency(arr) {
  if (!Array.isArray(arr)) {
    throw new Error("arr is not an array");
  }

  const result = {};

  for (const item of arr) {
    // 如果 result 中不存在 item 键，则初始化为 0，然后加 1
    // 如果 result 中存在 item 键，则直接加 1
    result[item] = (result[item] || 0) + 1;
  }

  return result;
}
```

提到键值对，很容易想到 ES6 的 `Map` 数据结构，逻辑与上面代码大差不差，只是使用 `Map` 代替

```js
function countFrequencyMap(arr) {
  if (!Array.isArray(arr)) {
    throw new Error("arr is not an array");
  }

  const map = new Map();
  for (const item of arr) {
    map.set(item, (map.get(item) || 0) + 1);
  }

  return map;
}
```

还可以使用 `reduce` 方法来实现

```js
const arr = [1, 2, 5, 5, 2, 4, "hello", "hey", "hello"];

const result = arr.reduce((prev, cur) => {
  prev[cur] = (prev[cur] || 0) + 1;
  return prev;
}, {});

console.log(result); // {1: 1, 2: 2, 5: 2, 4: 1, hello: 2, hey: 1}
```

## 考虑多维数组的处理情况

有些情况下，传入的参数可能是一个多维数组，我们需要先拍平成一维数组

使用 `flat` 方法拍平数组，然后使用 `reduce` 方法实现

>如果不用 `flat` 方法，也可以手写实现一个拍平数组的方法，之前写过，参考：[数组扁平化](https://github.com/bryqiu/Blog/blob/main/JavaScript%20%E6%89%8B%E6%92%95%E4%BB%A3%E7%A0%81/%E6%95%B0%E7%BB%84%E6%89%81%E5%B9%B3%E5%8C%96.md)

```js
const arr = [1, [2, 3,[3]], 4, [5, 6]];

const result = arr.flat(Infinity).reduce((prev, cur) => {
  prev[cur] = (prev[cur] || 0) + 1;
  return prev;
}, {});

console.log(result); // {1: 1, 2: 1, 3: 2, 4: 1, 5: 1, 6: 1}
```